# ğŸš€ MIRA Seeder Pipeline
## DocumentaciÃ³n TÃ©cnica Completa

<div align="center">

```
â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  
â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  
â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â•šâ•â•     â•šâ•â•â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•    â•šâ•â•     â•šâ•â•â•šâ•â•     â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•
```

**VersiÃ³n:** 1.0.0 | **Ãšltima EjecuciÃ³n:** 2025-11-30 | **Estado:** âœ… ProducciÃ³n

[![Python 3.8+](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![Laravel 10.x](https://img.shields.io/badge/Laravel-10.x-red.svg)](https://laravel.com)
[![Items](https://img.shields.io/badge/Items-400-green.svg)](#)
[![Modules](https://img.shields.io/badge/MÃ³dulos-5-purple.svg)](#)

</div>

---

## ğŸ“‹ Tabla de Contenidos

1. [Vista General](#-vista-general)
2. [Arquitectura del Pipeline](#-arquitectura-del-pipeline)
3. [Estructura de Directorios](#-estructura-de-directorios)
4. [Scripts del Pipeline](#-scripts-del-pipeline)
5. [Flujo de Datos](#-flujo-de-datos)
6. [Validaciones](#-validaciones)
7. [Trazabilidad](#-trazabilidad)
8. [GuÃ­a de Uso](#-guÃ­a-de-uso)
9. [EstadÃ­sticas de EjecuciÃ³n](#-estadÃ­sticas-de-ejecuciÃ³n)
10. [Troubleshooting](#-troubleshooting)
11. [Ejemplos de CÃ³digo](#-ejemplos-de-cÃ³digo)

---

## ğŸ¯ Vista General

El **MIRA Seeder Pipeline** es un sistema automatizado de dos etapas que transforma datos psicomÃ©tricos procesados (JSON) en seeders Laravel listos para producciÃ³n.

### Â¿QuÃ© problema resuelve?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           PROBLEMA ORIGINAL                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ Cientos de archivos batch-*.json dispersos en mÃºltiples directorios     â”‚
â”‚  âŒ Sin validaciÃ³n centralizada de calidad                                   â”‚
â”‚  âŒ Sin trazabilidad de origen de datos                                      â”‚
â”‚  âŒ Proceso manual propenso a errores                                        â”‚
â”‚  âŒ No compatible directamente con Laravel                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SOLUCIÃ“N: SEEDER PIPELINE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… ConsolidaciÃ³n automÃ¡tica con validaciones                                â”‚
â”‚  âœ… Trazabilidad completa (JSONL logs)                                       â”‚
â”‚  âœ… Seeder PHP listo para `php artisan db:seed`                              â”‚
â”‚  âœ… Transacciones atÃ³micas (DB::transaction)                                 â”‚
â”‚  âœ… Chunks optimizados para memoria                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CaracterÃ­sticas Principales

| CaracterÃ­stica | DescripciÃ³n |
|----------------|-------------|
| ğŸ”„ **ConsolidaciÃ³n** | Une todos los batches por mÃ³dulo en archivos Ãºnicos |
| âœ… **ValidaciÃ³n** | 7+ validaciones antes de generar el seeder |
| ğŸ“Š **Trazabilidad** | Logs JSONL lÃ­nea por lÃ­nea para auditorÃ­a |
| ğŸ›¡ï¸ **Seguridad** | Escape PHP completo (comillas, backslash, $) |
| âš¡ **Performance** | Chunks de 50 items para inserts optimizados |
| ğŸ” **Atomicidad** | Todo dentro de `DB::transaction()` |

---

## ğŸ—ï¸ Arquitectura del Pipeline

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         MIRA SEEDER PIPELINE - ARQUITECTURA                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                               â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â•‘   â”‚                        ETAPA 1: CONSOLIDACIÃ“N                        â”‚    â•‘
â•‘   â”‚                      consolidate_batches.py                          â”‚    â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
â•‘                                    â”‚                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚   module1/   â”‚  â”‚   module2/   â”‚  â”‚   module3/   â”‚  â”‚   module4/   â”‚ ... â•‘
â•‘   â”‚  block-B01/  â”‚  â”‚  block-B01/  â”‚  â”‚  block-B01/  â”‚  â”‚  block-B01/  â”‚     â•‘
â•‘   â”‚  block-B02/  â”‚  â”‚  block-B02/  â”‚  â”‚  block-B02/  â”‚  â”‚  block-B02/  â”‚     â•‘
â•‘   â”‚   â””â”€batch-*  â”‚  â”‚   â””â”€batch-*  â”‚  â”‚   â””â”€batch-*  â”‚  â”‚   â””â”€batch-*  â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘          â”‚                 â”‚                 â”‚                 â”‚              â•‘
â•‘          â–¼                 â–¼                 â–¼                 â–¼              â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘   â”‚                         VALIDACIONES                                  â”‚   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â•‘
â•‘   â”‚  â”‚module_idâ”‚ â”‚  type   â”‚ â”‚ length â”‚ â”‚  UTF-8  â”‚ â”‚ options  â”‚          â”‚   â•‘
â•‘   â”‚  â”‚ [1-5]  â”‚ â”‚video/optâ”‚ â”‚<60,000 â”‚ â”‚encoding â”‚ â”‚structuredâ”‚          â”‚   â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                    â”‚                                          â•‘
â•‘                                    â–¼                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘   â”‚                    ARCHIVOS CONSOLIDADOS                              â”‚   â•‘
â•‘   â”‚    module1_all.json  module2_all.json  ...  module5_all.json         â”‚   â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                    â”‚                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â•‘   â”‚                        ETAPA 2: GENERACIÃ“N                           â”‚    â•‘
â•‘   â”‚                        generate_seeder.py                            â”‚    â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
â•‘                                    â”‚                                          â•‘
â•‘                                    â–¼                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘   â”‚                       TRANSFORMACIÃ“N PHP                              â”‚   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚   â•‘
â•‘   â”‚  â”‚ Escape '    â”‚  â”‚ Escape "    â”‚  â”‚ Escape $    â”‚                   â”‚   â•‘
â•‘   â”‚  â”‚    â†’ \'     â”‚  â”‚    â†’ \"     â”‚  â”‚    â†’ \$     â”‚                   â”‚   â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                    â”‚                                          â•‘
â•‘                                    â–¼                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘   â”‚                    MiraPreguntasSeeder.php                            â”‚   â•‘
â•‘   â”‚           400 items â”‚ 8 chunks â”‚ DB::transaction()                    â”‚   â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“‚ Estructura de Directorios

```
Refactor_Factory/
â”‚
â”œâ”€â”€ ğŸ“ 01_processed_json/              # â† ENTRADA: JSONs procesados
â”‚   â”œâ”€â”€ ğŸ“ module1/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ block-B01/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ batch-01.json
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“„ batch-02.json
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„ batch-03.json
â”‚   â”‚   â””â”€â”€ ğŸ“ block-B02/
â”‚   â”‚       â”œâ”€â”€ ğŸ“„ batch-01.json
â”‚   â”‚       â””â”€â”€ ğŸ“„ batch-02.json
â”‚   â”œâ”€â”€ ğŸ“ module2/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ ğŸ“ module3/
â”‚   â”œâ”€â”€ ğŸ“ module4/
â”‚   â””â”€â”€ ğŸ“ module5/
â”‚
â”œâ”€â”€ ğŸ“ 02_final_artifacts/             # â† SALIDA: Artefactos finales
â”‚   â”œâ”€â”€ ğŸ“ consolidated/               # JSONs unificados por mÃ³dulo
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ module1_all.json        # 80 items
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ module2_all.json        # 80 items
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ module3_all.json        # 80 items
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ module4_all.json        # 80 items
â”‚   â”‚   â””â”€â”€ ğŸ“„ module5_all.json        # 80 items
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ seeders/                    # Seeder Laravel
â”‚   â”‚   â””â”€â”€ ğŸ“„ MiraPreguntasSeeder.php # âœ… LISTO PARA PRODUCCIÃ“N
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ logs/                       # Trazabilidad completa
â”‚       â”œâ”€â”€ ğŸ“„ consolidation_trace.jsonl   # Log lÃ­nea por lÃ­nea
â”‚       â”œâ”€â”€ ğŸ“„ seeder_trace.jsonl          # Transformaciones
â”‚       â””â”€â”€ ğŸ“„ execution_summary.json      # EstadÃ­sticas
â”‚
â””â”€â”€ ğŸ“ scripts/                        # Scripts del pipeline
    â”œâ”€â”€ ğŸ“„ consolidate_batches.py      # Etapa 1
    â””â”€â”€ ğŸ“„ generate_seeder.py          # Etapa 2
```

---

## ğŸ“œ Scripts del Pipeline

### Script 1: `consolidate_batches.py`

**PropÃ³sito:** Unir todos los `batch-*.json` de cada mÃ³dulo en un Ãºnico archivo `module{N}_all.json`.

```python
# UbicaciÃ³n: scripts/consolidate_batches.py
# Entradas:  01_processed_json/module{1-5}/block-*/batch-*.json
# Salidas:   02_final_artifacts/consolidated/module{1-5}_all.json
#            02_final_artifacts/logs/consolidation_trace.jsonl
```

#### ConfiguraciÃ³n Interna

| Variable | Valor | DescripciÃ³n |
|----------|-------|-------------|
| `MAX_TEXT_LENGTH` | 60,000 | LÃ­mite mÃ¡ximo de caracteres por texto |
| `VALID_MODULES` | [1,2,3,4,5] | IDs de mÃ³dulo vÃ¡lidos |
| `VALID_TYPES` | ['video','options'] | Tipos de pregunta vÃ¡lidos |
| `MIN_BATCHES` | 2 | MÃ­nimo de batches esperados por bloque |
| `MAX_BATCHES` | 4 | MÃ¡ximo de batches esperados por bloque |

#### Flujo de Procesamiento

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONSOLIDATE_BATCHES.PY                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Crear directorios de salida                                â”‚
â”‚     â””â”€ 02_final_artifacts/consolidated/                        â”‚
â”‚     â””â”€ 02_final_artifacts/logs/                                â”‚
â”‚                                                                 â”‚
â”‚  2. Para cada mÃ³dulo (1-5):                                    â”‚
â”‚     â”‚                                                           â”‚
â”‚     â”œâ”€ Buscar block-* directories                              â”‚
â”‚     â”‚                                                           â”‚
â”‚     â”œâ”€ Para cada bloque:                                       â”‚
â”‚     â”‚   â”‚                                                       â”‚
â”‚     â”‚   â”œâ”€ Buscar batch-*.json                                 â”‚
â”‚     â”‚   â”‚                                                       â”‚
â”‚     â”‚   â”œâ”€ Para cada batch:                                    â”‚
â”‚     â”‚   â”‚   â”‚                                                   â”‚
â”‚     â”‚   â”‚   â”œâ”€ Cargar JSON                                     â”‚
â”‚     â”‚   â”‚   â”œâ”€ Detectar formato (array vs {items:[]})          â”‚
â”‚     â”‚   â”‚   â”‚                                                   â”‚
â”‚     â”‚   â”‚   â””â”€ Para cada item:                                 â”‚
â”‚     â”‚   â”‚       â”œâ”€ âœ… Validar module_id                         â”‚
â”‚     â”‚   â”‚       â”œâ”€ âœ… Validar type                              â”‚
â”‚     â”‚   â”‚       â”œâ”€ âœ… Validar longitud texto                    â”‚
â”‚     â”‚   â”‚       â”œâ”€ âœ… Validar encoding UTF-8                    â”‚
â”‚     â”‚   â”‚       â”œâ”€ âœ… Validar options_structured                â”‚
â”‚     â”‚   â”‚       â””â”€ ğŸ“ Log en trace.jsonl                       â”‚
â”‚     â”‚   â”‚                                                       â”‚
â”‚     â”‚   â””â”€ Agregar items a lista del mÃ³dulo                    â”‚
â”‚     â”‚                                                           â”‚
â”‚     â””â”€ Guardar module{N}_all.json                              â”‚
â”‚                                                                 â”‚
â”‚  3. Imprimir resumen                                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Script 2: `generate_seeder.py`

**PropÃ³sito:** Transformar los JSONs consolidados en un seeder PHP Laravel.

```python
# UbicaciÃ³n: scripts/generate_seeder.py
# Entradas:  02_final_artifacts/consolidated/module*_all.json
# Salidas:   02_final_artifacts/seeders/MiraPreguntasSeeder.php
#            02_final_artifacts/logs/seeder_trace.jsonl
#            02_final_artifacts/logs/execution_summary.json
```

#### ParÃ¡metros CLI

| ParÃ¡metro | Default | DescripciÃ³n |
|-----------|---------|-------------|
| `--chunk-size` | 50 | TamaÃ±o de chunks para DB::insert() |

#### Escape PHP

El script aplica escape seguro para PHP:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CARÃCTER    â”‚              TRANSFORMACIÃ“N                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      \        â”‚  â†’  \\   (backslash escapado)                     â”‚
â”‚      '        â”‚  â†’  \'   (comilla simple escapada)                â”‚
â”‚      "        â”‚  â†’  \"   (comilla doble escapada)                 â”‚
â”‚      $        â”‚  â†’  \$   (prevenir interpolaciÃ³n de variables)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Estructura del Seeder Generado

```php
<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class MiraPreguntasSeeder extends Seeder
{
    /**
     * Run the database seeds.
     * 
     * Generado automÃ¡ticamente el 2025-11-30 23:57:24
     * Total items: 400
     * Chunks: 8 (tamaÃ±o: 50)
     */
    public function run()
    {
        DB::transaction(function () {

            // Chunk 1/8 (50 items)
            DB::table('mira_preguntas')->insert([
                [
                    'modulo' => 1,
                    'tipo' => 'video',
                    'texto' => '...',
                    'opciones' => '{}',
                    'idioma' => 'es',
                    'created_at' => now(),
                    'updated_at' => now(),
                ],
                // ... mÃ¡s items
            ]);

            // Chunk 2/8 (50 items)
            // ...

        });
        
        echo "Seeder completado. Items insertados: 400\n";
    }
}
```

---

## ğŸ”„ Flujo de Datos

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                              FLUJO DE DATOS COMPLETO                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                      â•‘
â•‘   â”‚   ITEM ORIGINAL     â”‚                                                      â•‘
â•‘   â”‚   (batch-01.json)   â”‚                                                      â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â–¼                                                                 â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚  {                                                                   â”‚     â•‘
â•‘   â”‚    "id": "block-B01-q001",                                          â”‚     â•‘
â•‘   â”‚    "module_id": 1,                                                   â”‚     â•‘
â•‘   â”‚    "type": "video",                                                  â”‚     â•‘
â•‘   â”‚    "refactored_text": "Tu supervisor te pide autorizar...",         â”‚     â•‘
â•‘   â”‚    "sot_checksum": "d4e8a8700e6621d98dd1e6b75dd1c9125..."           â”‚     â•‘
â•‘   â”‚  }                                                                   â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â”‚  consolidate_batches.py                                        â•‘
â•‘              â”‚  âœ… Validar   ğŸ“ Log trace                                      â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â–¼                                                                 â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚  module1_all.json                                                    â”‚     â•‘
â•‘   â”‚  [                                                                   â”‚     â•‘
â•‘   â”‚    { "id": "block-B01-q001", "module_id": 1, ... },                  â”‚     â•‘
â•‘   â”‚    { "id": "block-B01-q002", "module_id": 1, ... },                  â”‚     â•‘
â•‘   â”‚    ...                                                               â”‚     â•‘
â•‘   â”‚  ]                                                                   â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â”‚  generate_seeder.py                                            â•‘
â•‘              â”‚  ğŸ”„ Transform   ğŸ›¡ï¸ Escape PHP                                   â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â–¼                                                                 â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚  MiraPreguntasSeeder.php                                             â”‚     â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â•‘
â•‘   â”‚  â”‚  [                                                             â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'modulo' => 1,                                             â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'tipo' => 'video',                                         â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'texto' => 'Tu supervisor te pide autorizar...',           â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'opciones' => '{}',                                        â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'idioma' => 'es',                                          â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'created_at' => now(),                                     â”‚  â”‚     â•‘
â•‘   â”‚  â”‚    'updated_at' => now(),                                     â”‚  â”‚     â•‘
â•‘   â”‚  â”‚  ],                                                            â”‚  â”‚     â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â”‚  php artisan db:seed --class=MiraPreguntasSeeder               â•‘
â•‘              â”‚                                                                 â•‘
â•‘              â–¼                                                                 â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚  ğŸ’¾ TABLA: mira_preguntas                                           â”‚     â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â•‘
â•‘   â”‚  â”‚ id â”‚ modulo â”‚ tipo  â”‚        texto         â”‚opciones â”‚ idioma â”‚ â”‚     â•‘
â•‘   â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚     â•‘
â•‘   â”‚  â”‚  1 â”‚   1    â”‚ video â”‚ Tu supervisor te...  â”‚   {}    â”‚   es   â”‚ â”‚     â•‘
â•‘   â”‚  â”‚  2 â”‚   1    â”‚ video â”‚ En una cena de...    â”‚   {}    â”‚   es   â”‚ â”‚     â•‘
â•‘   â”‚  â”‚... â”‚  ...   â”‚  ...  â”‚         ...          â”‚   ...   â”‚  ...   â”‚ â”‚     â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## âœ… Validaciones

### Validaciones del Consolidador

| # | ValidaciÃ³n | Comportamiento si Falla | CÃ³digo de Error |
|---|------------|------------------------|-----------------|
| 1 | `module_id` en [1-5] | âŒ STOP - Exit(1) | `ERROR: module_id fuera de rango` |
| 2 | `type` es 'video' u 'options' | âŒ STOP - Exit(1) | `ERROR: type invÃ¡lido` |
| 3 | Longitud texto < 60,000 | âŒ STOP - Exit(1) | `ERROR: texto excede lÃ­mite` |
| 4 | Encoding UTF-8 vÃ¡lido | âŒ STOP - Exit(1) | `ERROR: caracteres no-UTF8` |
| 5 | `options_structured` existe (si type=options) | âŒ STOP - Exit(1) | `ERROR: falta options_structured` |
| 6 | `options_structured` es JSON vÃ¡lido | âŒ STOP - Exit(1) | `ERROR: JSON malformado` |
| 7 | Opciones requeridas presentes | âŒ STOP - Exit(1) | `ERROR: faltan opciones` |
| 8 | Cantidad de batches por bloque | âš ï¸ WARNING | ContinÃºa pero alerta |

### Opciones Requeridas en `options_structured`

```json
{
  "integrity_correct": "...",        // âœ… Requerida
  "pragmatic_distractor": "...",     // âœ… Requerida
  "evasive_distractor": "...",       // âœ… Requerida
  "rationalized_distractor": "..."   // âœ… Requerida
}
```

### Diagrama de ValidaciÃ³n

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  ITEM JSON   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                                 â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ module_id âˆˆ   â”‚                 â”‚   type âˆˆ      â”‚
           â”‚   [1,2,3,4,5] â”‚                 â”‚ [video,options]â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                                 â”‚
                   â–¼ âŒ                               â–¼ âŒ
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  EXIT(1)    â”‚                   â”‚  EXIT(1)    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ âœ…                               â”‚ âœ…
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ len(texto) <  â”‚
                           â”‚    60,000     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                          âŒ       â”‚        âœ…
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                             â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  EXIT(1)    â”‚             â”‚  UTF-8 vÃ¡lido â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚
                                        âŒ       â”‚        âœ…
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â–¼                             â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚  EXIT(1)    â”‚             â”‚ type==options?â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                      No       â”‚      SÃ­
                                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                â–¼                             â–¼
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚  âœ… VÃLIDO  â”‚             â”‚options_struct?â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                             â”‚
                                                                    âŒ       â”‚        âœ…
                                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                              â–¼                             â–¼
                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                       â”‚  EXIT(1)    â”‚             â”‚ 4 keys exist? â”‚
                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                                           â”‚
                                                                                  âŒ       â”‚        âœ…
                                                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                            â–¼                         â–¼
                                                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                     â”‚  EXIT(1)    â”‚         â”‚  âœ… VÃLIDO  â”‚
                                                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Trazabilidad

### Archivos de Log Generados

```
02_final_artifacts/logs/
â”œâ”€â”€ consolidation_trace.jsonl   # Trazabilidad de consolidaciÃ³n
â”œâ”€â”€ seeder_trace.jsonl          # Trazabilidad de transformaciÃ³n
â””â”€â”€ execution_summary.json      # EstadÃ­sticas globales
```

### Formato: `consolidation_trace.jsonl`

Cada lÃ­nea es un objeto JSON independiente:

```json
{
  "id": "block-B01-q001",
  "source_batch": "block-B01/batch-01.json",
  "module": 1,
  "type": "video",
  "checksum": "d4e8a8700e6621d98dd1e6b75dd1c9125cd2498f...",
  "texto_chars": 366,
  "timestamp": "2025-11-30T23:56:13.858967"
}
```

### Formato: `seeder_trace.jsonl`

```json
{
  "id": "block-B01-q001",
  "modulo": 1,
  "tipo": "video",
  "texto_chars": 366,
  "opciones_chars": 2,
  "row_num": 1,
  "timestamp": "2025-11-30T23:57:24.000000"
}
```

### Formato: `execution_summary.json`

```json
{
  "timestamp": "2025-11-30T23:57:24.128168",
  "total_items": 400,
  "chunk_size": 50,
  "chunks_count": 8,
  "by_module": {
    "1": 80,
    "2": 80,
    "3": 80,
    "4": 80,
    "5": 80
  },
  "by_type": {
    "video": 200,
    "options": 200
  },
  "files_processed": [
    "module1_all.json",
    "module2_all.json",
    "module3_all.json",
    "module4_all.json",
    "module5_all.json"
  ]
}
```

---

## ğŸ› ï¸ GuÃ­a de Uso

### EjecuciÃ³n Completa del Pipeline

```bash
# Paso 1: Consolidar batches
python scripts/consolidate_batches.py

# Paso 2: Generar seeder Laravel
python scripts/generate_seeder.py

# Opcional: Cambiar tamaÃ±o de chunk
python scripts/generate_seeder.py --chunk-size 100
```

### EjecuciÃ³n del Seeder en Laravel

```bash
# Copiar seeder a tu proyecto Laravel
cp 02_final_artifacts/seeders/MiraPreguntasSeeder.php \
   /path/to/laravel/database/seeders/

# Ejecutar seeder
cd /path/to/laravel
php artisan db:seed --class=MiraPreguntasSeeder
```

### Comandos Ãštiles

```bash
# Ver estadÃ­sticas de ejecuciÃ³n
cat 02_final_artifacts/logs/execution_summary.json | python -m json.tool

# Contar items por mÃ³dulo en logs
grep -c '"module": 1' 02_final_artifacts/logs/consolidation_trace.jsonl
grep -c '"module": 2' 02_final_artifacts/logs/consolidation_trace.jsonl
# ...

# Ver primeras lÃ­neas del trace
head -n 10 02_final_artifacts/logs/consolidation_trace.jsonl

# Verificar estructura del seeder
head -n 50 02_final_artifacts/seeders/MiraPreguntasSeeder.php
```

---

## ğŸ“ˆ EstadÃ­sticas de EjecuciÃ³n

### Ãšltima EjecuciÃ³n: 2025-11-30 23:57:24

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ESTADÃSTICAS DE EJECUCIÃ“N                        â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                     â•‘
â•‘   ğŸ“Š TOTALES                                                        â•‘
â•‘   â”œâ”€â”€ Items procesados:        400                                  â•‘
â•‘   â”œâ”€â”€ MÃ³dulos:                   5                                  â•‘
â•‘   â”œâ”€â”€ Chunks generados:          8                                  â•‘
â•‘   â””â”€â”€ TamaÃ±o de chunk:          50                                  â•‘
â•‘                                                                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                     â•‘
â•‘   ğŸ“¦ POR MÃ“DULO                                                     â•‘
â•‘                                                                     â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚   MÃ³dulo   â”‚  Items  â”‚            Barra de Progreso         â”‚  â•‘
â•‘   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘   â”‚  MÃ³dulo 1  â”‚   80    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  20%            â”‚  â•‘
â•‘   â”‚  MÃ³dulo 2  â”‚   80    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  20%            â”‚  â•‘
â•‘   â”‚  MÃ³dulo 3  â”‚   80    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  20%            â”‚  â•‘
â•‘   â”‚  MÃ³dulo 4  â”‚   80    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  20%            â”‚  â•‘
â•‘   â”‚  MÃ³dulo 5  â”‚   80    â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  20%            â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                     â•‘
â•‘   ğŸ¬ POR TIPO DE PREGUNTA                                           â•‘
â•‘                                                                     â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘   â”‚                                                             â”‚   â•‘
â•‘   â”‚   VIDEO    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  200 (50%)â”‚   â•‘
â•‘   â”‚                                                             â”‚   â•‘
â•‘   â”‚   OPTIONS  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  200 (50%)â”‚   â•‘
â•‘   â”‚                                                             â”‚   â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### GrÃ¡fico de DistribuciÃ³n

```
                    DISTRIBUCIÃ“N DE ITEMS POR MÃ“DULO Y TIPO

    MÃ³dulo â”‚          VIDEO          â”‚         OPTIONS
    â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         1 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40
         2 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40
         3 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40
         4 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40
         5 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40
    â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     TOTAL â”‚                     200 â”‚                     200
```

---

## ğŸ”§ Troubleshooting

### Errores Comunes

<details>
<summary><strong>âŒ ERROR: module_id fuera de rango vÃ¡lido [1-5]</strong></summary>

**Causa:** Un item tiene `module_id` que no es 1, 2, 3, 4, o 5.

**SoluciÃ³n:**
```bash
# Encontrar el item problemÃ¡tico
grep -rn '"module_id":' 01_processed_json/ | grep -v '"module_id": [1-5]'

# Corregir manualmente o regenerar el batch
```

</details>

<details>
<summary><strong>âŒ ERROR: type invÃ¡lido</strong></summary>

**Causa:** El campo `type` no es 'video' ni 'options'.

**SoluciÃ³n:**
```bash
# Buscar types incorrectos
grep -rn '"type":' 01_processed_json/ | grep -v -E '"type": "(video|options)"'
```

</details>

<details>
<summary><strong>âŒ ERROR: JSON malformado</strong></summary>

**Causa:** El archivo batch-*.json tiene sintaxis JSON invÃ¡lida.

**SoluciÃ³n:**
```bash
# Validar JSON
python -m json.tool < 01_processed_json/module1/block-B01/batch-01.json
```

</details>

<details>
<summary><strong>âš ï¸ WARNING: Bloque tiene X batches (esperado: 2-4)</strong></summary>

**Causa:** El bloque tiene menos de 2 o mÃ¡s de 4 archivos batch.

**AcciÃ³n:** Es solo un warning. El pipeline continÃºa pero revisa si esto es intencional.

</details>

<details>
<summary><strong>âŒ ERROR: No se encontraron archivos consolidados</strong></summary>

**Causa:** No existen los archivos `module*_all.json` en `02_final_artifacts/consolidated/`.

**SoluciÃ³n:**
```bash
# Ejecutar primero el consolidador
python scripts/consolidate_batches.py
```

</details>

### VerificaciÃ³n de Salud

```bash
# Verificar que existen los archivos de entrada
ls -la 01_processed_json/

# Verificar que existen archivos consolidados
ls -la 02_final_artifacts/consolidated/

# Verificar que el seeder fue generado
ls -la 02_final_artifacts/seeders/

# Ver resumen de ejecuciÃ³n
cat 02_final_artifacts/logs/execution_summary.json
```

---

## ğŸ’» Ejemplos de CÃ³digo

### Ejemplo: Item Tipo Video

**Entrada (batch-01.json):**
```json
{
  "id": "block-B01-q001",
  "module_id": 1,
  "type": "video",
  "refactored_text": "Tu supervisor te pide autorizar una compra muy cara que rebasa el presupuesto del trimestre. Te asegura que es la Ãºnica forma de salvar un proyecto clave y que, si pones la verdad, la direcciÃ³n puede frenar el gasto y culpar a tu Ã¡rea. Te propone registrarla con otro concepto para que pase sin revisiÃ³n. Â¿QuÃ© decisiÃ³n tomas y cÃ³mo la explicas a tu jefe y al equipo?",
  "sot_checksum": "d4e8a8700e6621d98dd1e6b75dd1c9125cd2498f3ae554410cce59ce0f441001"
}
```

**Salida (PHP Seeder):**
```php
[
    'modulo' => 1,
    'tipo' => 'video',
    'texto' => 'Tu supervisor te pide autorizar una compra muy cara...',
    'opciones' => '{}',
    'idioma' => 'es',
    'created_at' => now(),
    'updated_at' => now(),
],
```

---

### Ejemplo: Item Tipo Options

**Entrada (batch-02.json):**
```json
{
  "id": "block-B02-q015",
  "module_id": 1,
  "type": "options",
  "scenario": "Un colega te confiesa que ha estado registrando horas extra que no trabajÃ³...",
  "options_structured": {
    "integrity_correct": "Reporto la situaciÃ³n a mi supervisor inmediato.",
    "pragmatic_distractor": "Lo dejo pasar porque no me afecta directamente.",
    "evasive_distractor": "Espero a ver si alguien mÃ¡s lo reporta primero.",
    "rationalized_distractor": "Le digo que lo deje de hacer pero no reporto."
  }
}
```

**Salida (PHP Seeder):**
```php
[
    'modulo' => 1,
    'tipo' => 'options',
    'texto' => 'Un colega te confiesa que ha estado registrando...',
    'opciones' => '{"opciones":["Reporto la situaciÃ³n a mi supervisor inmediato.","Lo dejo pasar porque no me afecta directamente.","Espero a ver si alguien mÃ¡s lo reporta primero.","Le digo que lo deje de hacer pero no reporto."]}',
    'idioma' => 'es',
    'created_at' => now(),
    'updated_at' => now(),
],
```

> **Nota:** La columna `opciones` almacena un JSON con una lista de 4 strings en orden fijo:
> `[integrity_correct, pragmatic_distractor, evasive_distractor, rationalized_distractor]`.
> Las claves psicomÃ©tricas originales se preservan en los JSON consolidados pero no en el seeder.

---

## ğŸ“š ApÃ©ndice

### Esquema de Base de Datos

```sql
CREATE TABLE mira_preguntas (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    modulo INT NOT NULL,              -- 1-5
    tipo VARCHAR(20) NOT NULL,        -- 'video' | 'options'
    texto TEXT NOT NULL,              -- Escenario/pregunta
    opciones JSON,                    -- {} para videos, {"opciones": [...]} para options
    idioma VARCHAR(10) DEFAULT 'es',  -- CÃ³digo de idioma
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    
    INDEX idx_modulo (modulo),
    INDEX idx_tipo (tipo)
);
```

> **Formato de `opciones`:**
> - Para tipo `video`: `{}`
> - Para tipo `options`: `{"opciones": ["opcion1", "opcion2", "opcion3", "opcion4"]}`

### Requisitos del Sistema

| Requisito | VersiÃ³n MÃ­nima |
|-----------|----------------|
| Python | 3.8+ |
| Laravel | 10.x |
| PHP | 8.1+ |
| MySQL/PostgreSQL | 8.0+ / 14+ |

---

<div align="center">

---

**ğŸ­ MIRA Refactor Factory** | Seeder Pipeline v1.0.0

DocumentaciÃ³n generada automÃ¡ticamente | 2025-11-30

</div>
